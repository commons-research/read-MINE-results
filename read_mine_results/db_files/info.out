
Existing columns: ['ID', 'Type', 'Generation', 'Formula', 'InChIKey', 'SMILES'] | File: cleaned_files_3x/compounds_1_generalized_230106_frozen_metadata_for_MINES_split_02.csv_72696.32_.parquet
Updated columns: ['ID', 'Type', 'Formula', 'InChIKey', 'SMILES']

Existing columns: ['ID', 'Type', 'Generation', 'Formula', 'InChIKey', 'SMILES'] | File: cleaned_files_3x/compounds_1_generalized_230106_frozen_metadata_for_MINES_split_00.csv_77226.91_.parquet
Updated columns: ['ID', 'Type', 'Formula', 'InChIKey', 'SMILES']

Existing columns: ['ID', 'Name', 'ID equation', 'SMILES equation', 'Rxn hash', 'Reaction rules'] | File: cleaned_files_3x/reactions_1_generalized_230106_frozen_metadata_for_MINES_split_00.csv_77226.91_.parquet
Updated columns: ['ID', 'ID equation', 'SMILES equation', 'Rxn hash', 'Reaction rules']

Existing columns: ['ID', 'Name', 'ID equation', 'SMILES equation', 'Rxn hash', 'Reaction rules'] | File: cleaned_files_3x/reactions_1_generalized_230106_frozen_metadata_for_MINES_split_01.csv_81927.22_.parquet
Updated columns: ['ID', 'ID equation', 'SMILES equation', 'Rxn hash', 'Reaction rules']

Existing columns: ['ID', 'Type', 'Generation', 'Formula', 'InChIKey', 'SMILES'] | File: cleaned_files_3x/compounds_1_generalized_230106_frozen_metadata_for_MINES_split_01.csv_81927.22_.parquet
Updated columns: ['ID', 'Type', 'Formula', 'InChIKey', 'SMILES']

Existing columns: ['ID', 'Name', 'ID equation', 'SMILES equation', 'Rxn hash', 'Reaction rules'] | File: cleaned_files_3x/reactions_1_generalized_230106_frozen_metadata_for_MINES_split_02.csv_72696.32_.parquet
Updated columns: ['ID', 'ID equation', 'SMILES equation', 'Rxn hash', 'Reaction rules']
other file - read in :
 ['cleaned_files_3x/compounds_1_generalized_230106_frozen_metadata_for_MINES_split_00.csv_77226.91_.parquet', 'cleaned_files_3x/compounds_1_generalized_230106_frozen_metadata_for_MINES_split_01.csv_81927.22_.parquet']
check_if_only_duplicates shape: (1, 1)
┌───────┐
│ count │
│ ---   │
│ u32   │
╞═══════╡
│ 2     │
└───────┘ <class 'polars.dataframe.frame.DataFrame'>
File 1: compounds_1_generalized_230106_frozen_metadata_for_MINES_split_00.csv_77226.91_.parquet,
File 2: compounds_1_generalized_230106_frozen_metadata_for_MINES_split_01.csv_81927.22_.parquet
Total: 47_713_535
unique compounds: 47_175_239 (1.13 % - 538_296 duplicates)
-----
Compound file - filter for predicted compounds - read in : cleaned_files_3x/compounds_1_generalized_230106_frozen_metadata_for_MINES_split_01.csv_81927.22_.parquet
Reaction file read in : cleaned_files_3x/reactions_1_generalized_230106_frozen_metadata_for_MINES_split_01.csv_81927.22_.parquet
other file - read in :
 ['cleaned_files_3x/reactions_1_generalized_230106_frozen_metadata_for_MINES_split_00.csv_77226.91_.parquet', 'cleaned_files_3x/reactions_1_generalized_230106_frozen_metadata_for_MINES_split_01.csv_81927.22_.parquet']
loaded over all files:  54_178_443 
duplicates founded:  100
Traceback (most recent call last):
  File "/data/users/pamrein/2024_masterthesis/read-MINE-results/read_mine_results/db_files/02_remove_duplicates.py", line 348, in <module>
    reactions_cleaned.sink_parquet(reaction_file_to_rename + "_removed_duplicates.parquet")
  File "/home/pamrein/micromamba/envs/read-MINEs/lib/python3.10/site-packages/polars/_utils/unstable.py", line 59, in wrapper
    return function(*args, **kwargs)
  File "/home/pamrein/micromamba/envs/read-MINEs/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 2228, in sink_parquet
    return lf.sink_parquet(
polars.exceptions.InvalidOperationError: `is_in` cannot check for Boolean values in String data

This error occurred with the following context stack:
	[1] 'filter' failed
	[2] 'sink' input failed to resolve

